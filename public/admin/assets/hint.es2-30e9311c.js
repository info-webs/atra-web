import{C as f}from"./codemirror.es-52e8b92d.js";import{s as L}from"./forEachState.es-b2033c2b.js";import"./codemirror.es2-5884f31a.js";import{e as h,f as b,i as T,n as d,h as j,d as D}from"./index-6237cf3e.js";var N=Object.defineProperty,p=(i,r)=>N(i,"name",{value:r,configurable:!0});function u(i,r,t){const n=x(t,m(r.string));if(!n)return;const e=r.type!==null&&/"|\w/.test(r.string[0])?r.start:r.end;return{list:n,from:{line:i.line,ch:e},to:{line:i.line,ch:r.end}}}p(u,"hintList");function x(i,r){if(!r)return y(i,n=>!n.isDeprecated);const t=i.map(n=>({proximity:V(m(n.text),r),entry:n}));return y(y(t,n=>n.proximity<=2),n=>!n.entry.isDeprecated).sort((n,e)=>(n.entry.isDeprecated?1:0)-(e.entry.isDeprecated?1:0)||n.proximity-e.proximity||n.entry.text.length-e.entry.text.length).map(n=>n.entry)}p(x,"filterAndSortList");function y(i,r){const t=i.filter(r);return t.length===0?i:t}p(y,"filterNonEmpty");function m(i){return i.toLowerCase().replaceAll(/\W/g,"")}p(m,"normalizeText");function V(i,r){let t=v(r,i);return i.length>r.length&&(t-=i.length-r.length-1,t+=i.indexOf(r)===0?0:.5),t}p(V,"getProximity");function v(i,r){let t,n;const e=[],a=i.length,s=r.length;for(t=0;t<=a;t++)e[t]=[t];for(n=1;n<=s;n++)e[0][n]=n;for(t=1;t<=a;t++)for(n=1;n<=s;n++){const c=i[t-1]===r[n-1]?0:1;e[t][n]=Math.min(e[t-1][n]+1,e[t][n-1]+1,e[t-1][n-1]+c),t>1&&n>1&&i[t-1]===r[n-2]&&i[t-2]===r[n-1]&&(e[t][n]=Math.min(e[t][n],e[t-2][n-2]+c))}return e[a][s]}p(v,"lexicalDistance");f.registerHelper("hint","graphql-variables",(i,r)=>{const t=i.getCursor(),n=i.getTokenAt(t),e=O(t,n,r);return e!=null&&e.list&&e.list.length>0&&(e.from=f.Pos(e.from.line,e.from.ch),e.to=f.Pos(e.to.line,e.to.ch),f.signal(i,"hasCompletion",i,e,n)),e});function O(i,r,t){const n=r.state.kind==="Invalid"?r.state.prevState:r.state,{kind:e,step:a}=n;if(e==="Document"&&a===0)return u(i,r,[{text:"{"}]);const{variableToType:s}=t;if(!s)return;const c=k(s,r.state);if(e==="Document"||e==="Variable"&&a===0){const o=Object.keys(s);return u(i,r,o.map(l=>({text:`"${l}": `,type:s[l]})))}if((e==="ObjectValue"||e==="ObjectField"&&a===0)&&c.fields){const o=Object.keys(c.fields).map(l=>c.fields[l]);return u(i,r,o.map(l=>({text:`"${l.name}": `,type:l.type,description:l.description})))}if(e==="StringValue"||e==="NumberValue"||e==="BooleanValue"||e==="NullValue"||e==="ListValue"&&a===1||e==="ObjectField"&&a===2||e==="Variable"&&a===2){const o=c.type?h(c.type):void 0;if(o instanceof b)return u(i,r,[{text:"{"}]);if(o instanceof T){const l=o.getValues();return u(i,r,l.map(g=>({text:`"${g.name}"`,type:o,description:g.description})))}if(o===d)return u(i,r,[{text:"true",type:d,description:"Not false."},{text:"false",type:d,description:"Not true."}])}}p(O,"getVariablesHint");function k(i,r){const t={type:null,fields:null};return L(r,n=>{switch(n.kind){case"Variable":{t.type=i[n.name];break}case"ListValue":{const e=t.type?j(t.type):void 0;t.type=e instanceof D?e.ofType:null;break}case"ObjectValue":{const e=t.type?h(t.type):void 0;t.fields=e instanceof b?e.getFields():null;break}case"ObjectField":{const e=n.name&&t.fields?t.fields[n.name]:null;t.type=e==null?void 0:e.type;break}}}),t}p(k,"getTypeInfo");
